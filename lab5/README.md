**高级计算机系统结构：GPU异构计算实践**

**作业 5：SGEMV kernel优化**
截止日期：2024年12月10日，星期二 - 上午10:00

**提交：**
用开发者账号登录沐曦算子竞赛平台(https://operator.metax-tech.com/)，上传修改后的项目工程，参加竞赛排名。

=================================================================================
**题目描述：SGEMV kernel优化**
=================================================================================
# SGEMV介绍

SGEMV（Single-precision General Matrix-Vector multiplication）是BLAS（Basic Linear Algebra Subprograms）库中的一个函数，它用于执行单精度浮点数的矩阵-向量乘法。以下是SGEMV的一些应用介绍和场景：
1. 科学计算：SGEMV在科学计算中广泛应用，特别是在需要解决线性方程组、计算特征值和特征向量等线性代数问题时。
2. 机器学习：在机器学习领域，SGEMV可以用于训练算法中的参数更新，例如在梯度下降法中计算权重的更新。
3. 图像处理：SGEMV在图像处理中也有应用，例如在图像滤波、图像变换等操作中，这些操作往往涉及到矩阵与向量的乘法。
4. 游戏开发：在游戏开发中，SGEMV可以用于物理模拟、角色动画和图形渲染等领域，这些领域中经常需要进行大量的线性代数计算。
5. 向量数据库计算：在向量数据库中，检索操作可以看作是一个SGEMV的计算过程，即向量与矩阵的相似度计算，这属于计算密度较低的计算场景，适合vector计算单元发挥作用。

# SGEMV kernel基础代码

[kernel.h]和[kernel.cpp]给出了最基础的SGEMV kernel代码，根据课程中学习的知识，网上搜索SGEMV kernel优化的相关文章，对SGEMV kernel进行优化。


## 编译和运行

```
mkdir build
cd build
cmake ..
make
./program
```
## 优化

SGEMV因其在多种计算密集型应用中的重要性，成为了GPU编程中性能优化的重点对象。通过优化SGEMV的实现，可以显著提升GPU运算速度，充分利用硬件资源。

SGEMV kernel 优化策略包括设计合适的块和线程布局，以避免线程空闲，以及针对不同矩阵尺寸（n=32、n<32、n>32）的情况提出相应的解决方案。修改[kernel.h]和[kernel.cpp]，尝试优化SGEMV kernel。

优化后的SGEMV kernel在某些场景下甚至可以超越GPU厂商BLAS库函数的性能。GPU厂商BLAS库函数：SGEMV是BLAS库中的Level 2函数，提供矩阵向量操作。它接受矩阵A、向量x和y以及乘法系数alpha和beta作为输入，执行矩阵-向量乘法运算。

